# Проект по построению модели предсказания рекомендаций по дополнительной лабораторной диагностике с GUI на customtkinter

## Статус проекта: 
завершен

## Ключевые слова проекта: 
- мультиклассовая классификация
- подбор гиперпараметров
- градиентный бустинг
- логистическая регрессия
- AUC-ROC

## Вводные данные проекта:

Необходимо подготовить модель машинного обучения для клинико-диагностической лаборатории, предоставляющей весь спектр медицинских анализов. 

Модель должна предсказать какие дополнительные исследования необходимо выполнить, если в текущих результатах анализов пациента имеются отклонения от нормы (выше или ниже нормы референсных значений лаборатории). Для обучения и предсказания будем использовать обезличенные данные с результатами анализов за период с 2019 по 2022 гг. с указанием отклонений в конкретных медицинских анализах (далее тестах). 

**Целью проекта** является построение модели предсказания рекомендаций по дополнительным тестам, которые необходимы для дальнейшей диагностики или лечения. Это позволит повысить прибыль лаборатории за счет прохождения пациентами дополнительных обследований, а также выявить отклонения на ранних стадиях заболеваний - сахарного диабета, анемии, тромбоза, болезни почек, сердца и печени. 


**Этапы проекта:**
1. Провести предобработку данных и подготовить их к построению модели
2. Обучить и оценить результаты нескольких моделей
3. Осуществить подбор параметров для лучших моделей и выбрать одну для тестирования
4. Протестировать модель и сравнить результаты с константной моделью
5. Сделать выводы по результатам проекта


## Используемые библиотеки:
- pandas
- numpy
- phik
- matplotlib
- seaborn
- sklearn
- joblib
- tkinter 
- customtkinter

## Выводы по результатам проекта:

**В ходе проекта были выполнены следующие этапы:**

- Проведена предобработка данных и подготовка их к построению модели.
- Проведен подбор гиперпараметров и проверка моделей кросс-валидацией.
- Обучены и оценены результаты следующих моделей: 

Модель                                      | F1-мера              | roc_auc_ovr        | 
-------------------------------             | -------------------- | ------------------ |
HistGradientBoostingClassifier()            | 0.9880024161745189   |  0.8979784982105137
RandomForestClassifier()                    | 0.995900919299452    |  0.9999208357025825   
DecisionTreeClassifier & BaggingClassifier()| 0.996128149488036    |  0.9999494697243289      
**LogisticRegression()**                    | 0.9979791594456238   |  0.9999606957324537     

Лучшие метрики показала модель LogisticRegression().


По результатам кросс-валидации выбрана **модель LogisticRegression** c максимальным значением метрики f1 и минимальным стандартным отклонением из всех проверяемых моделей (f1 = 0.99, стандартное отклонение = 0.002).

Результаты лучшей модели на тестовой выборке:
roc_auc_ovr: 0.999899
f1-мера : 0.996697

Параметры полученной модели:

**LogisticRegression(random_state=12345, penalty = 'none', solver='newton-cg', class_weight='balanced')**

- реализован графический интерфейс для работы с предсказанием модели.
