# Проект по построению модели прогнозирования остатков на расчетных счетах физических лиц

## Статус проекта: 
завершен

## Ключевые слова проекта: 
- временные ряды
- Prophet
- CatBoost
- LihgtGBM

## Вводные данные проекта:

**Заказчик:** казначейство Сбербанка.

**Цель проекта:** построить модель, которая прогнозирует объем стабильной части средств на дату.

**Дополнительные условия заказчика:**
- Критерии качества модели - нужно одновременно минимизировать величины:
    - максимальный объем пробития стабильной части на валидационной выборке; 
    - фактическая стабильная часть – модельная стабильная часть; 

**Данные для анализа и построения модели:** подневные данные объема расчетных счетов физических лиц за период 30.12.2013 - 10.10.2019 гг.

**Этапы проекта:**

1. Загрузить, проанализировать данные и подготовить их к обучению (создать дополнительные признаки).
2. Осуществить подбор параметров для лучших моделей и выбрать одну для тестирования.
3. Протестировать модель.
4. Сделать выводы по результатам проекта.


## Используемые библиотеки:
- pandas
- numpy
- statsmodels
- matplotlib
- seaborn
- sklearn
- prophet
- catboost
- lightgbm

## Выводы по результатам проекта:

В ходе работы над проектом были выполнены следующие задачи:
- Проведена предобработка данных и подготовка их к построению модели.
- В ходе исследовательского анализа данных был `выявлен положительный тренд` в анализируемом временном ряду и `еженедельная цикличность (сезонность)` - максимальный объем ресурсов на счетах ФЛ достигается в пятницу, субботу и воскресенье.

Для прогнозирования использовались следующие модели ML:
- Ridge;	
- Prophet;
- CatBoostRegressor;
- LGBMRegressor.


`Лучшие результаты` по предсказанию объемов привлеченных средств физических лиц на расчетных счетах показала `модель Ridge` (RMSE на тестовой выборке: 3441.3 млн. руб.) благодаря удачно подобранным синтетическим признакам. Неоспоримым `преимуществом данной модели` является `быстрота обучения` и `простота` построения.

Однако не следует исключать из перспективных моделей `Prophet`, так как при более точечном подборе гиперпараметров она может дать высокие результаты. Кроме того, эта модель имеет специализированные надстройки и параметры для работы с временными рядами - создание синтетических признаков, отметки о сезонности, трендах, праздниках конкретной страны и т.д.

Для более точного прогноза остатков на расчетных счетах `рекомендуется:`
- строить `прогноз в разбивке по валютам`, так как поведение клиента будет значительно отличаться относительно счетов в рублях и прочей валюте;
- `проанализировать тарифную политику` в части начисления процентов на остатки по счетам - возможно рост средств в выходные связан с доп доходом для клиента и это можно учесть в прогнозной модели;
- `провести кластеризация` клиентов, основываясь на их доходности для банка, перечне используемых услуг и т.д. Это позволит прогнозировать колебания объемов средств более прицельно;
- `провести АВС анализ клиентов`, чтобы сформировать портрет и закономерности в поведении тех 20% клиентов, доля средств которых образует 80% всех объемов средств ФЛ на р/с. Полученную информацию можно использовать для создания синтетических признаков - предсказывать не только движение средств, но и специфичные паттерны  поведения целевых клиентов.
